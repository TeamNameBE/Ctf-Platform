{% load static %}

{% load CTF %}
{% load gravatar %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>{{ page_title }}</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="author" content="" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
</head>

<body>
    <nav class="navbar bg-dark navbar-expand-lg" style="height: 5vh" data-bs-theme="dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="https://getbootstrap.com/docs/5.3/assets/brand/bootstrap-logo.svg" alt="Logo" width="30" height="24" class="d-inline-block align-text-top">
                Team Name
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link {% if "Dashboard" in page_title %}active{% endif %}" aria-current="page" href="{% url "dashboard" %}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link {% if "Calendar" in page_title %}active{% endif %}" href="{% url 'calendar' %}">Calendar</a>
                    </li>

                    {% current_ctf as current_ctf %}
                    {% if current_ctf %}
                        <li class="nav-item">
                            <a
                                class="nav-link {% if "Challenges" in page_title %}active{% endif %}"
                                href="{% url 'chal' current_ctf.id %}"
                            >Challenges</a>
                        </li>
                    {% elif "Challenges" in page_title %}
                        <a 
                        class="bg-blue-700 text-white current px-3 py-2 rounded-md text-sm font-medium" data-target="2">Challenges</a>
                        <li class="nav-item">
                            <a
                                class="nav-link {% if "Calendar" in page_title %}active{% endif %}"
                                href="{% url 'chal' ctf.id %}"
                            >Challenges</a>
                        </li>
                    {% endif %}

                    <li class="nav-item">
                        <a
                            href="#"
                            class="nav-link {% if "Pads" in page_title %}active{% endif %}"
                            data-target="3">
                            Pads</a>
                    </li>
                </ul>
                <span class="navbar-text">
                    <div class="dropdown">
                        <button class="btn btn-secondary btn-sm dropdown-toggle p-1 me-5" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <img class="navbar-brand mr-1" width="20" src="{% gravatar request.user %}" alt="user-gravatar" />
                            {{ request.user.username }}
                        </button>
                        <ul class="dropdown-menu dropdown-menu-dark">
                            <li>
                                <a href="{% url "password_change" %}?next=/" class="dropdown-item">Changer le mot de passe</a>
                            </li>
                            {% if user.is_superuser %}
                                <li>
                                    <a href="/admin" class="dropdown-item">Admin</a>
                                </li>
                            {% endif %}

                            <li><hr class="dropdown-divider"></li>
                            <li><a href="{% url "logout" %}?next=/" class="dropdown-item">DÃ©connexion</a></li>
                        </ul>
                    </div>
                </span>
            </div>
        </div>
    </nav>

    <div class="container-fluid flex-grow-1 bg-black" style="height: 95vh">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-primary alert-dismissible fade show {% if message.tags %} {{ message.tags }} {% endif %}" role="alert">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        
        {% block content %}
        {% endblock %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
</body>
</html>